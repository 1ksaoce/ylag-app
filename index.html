<!DOCTYPE html>
<html lang="vi">
<head>
   <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
    <title>YLAG: 90 Days Discipline</title>

    <link rel="icon" type="image/png" href="Icon.jpg">

    <link rel="apple-touch-icon" href="Icon.jpg">
    
    <link rel="stylesheet" href="style.css">
</head>
</head>

<body>

<div id="loading">
    <div>‚è≥</div>
    <div>ƒêang t·∫£i d·ªØ li·ªáu...</div>
</div>

<div class="app-container">
    <div class="header">
        <div style="display:flex; gap:10px; align-items:center;">
            <div style="width:45px; height:45px; background:#0e0c00; color:#fff; border-radius:50%; display:flex; justify-content:center; align-items:center; font-size:20px;">üêú</div>
            <div>
                <div style="font-weight:bold;">Control Habits</div>
                <div style="font-size:11px; color:#666;" id="currentDateStr">Loading...</div>
            </div>
        </div>
        <div style="display:flex; gap:10px;">
           
            <div style="font-weight:bold; border:2px solid #000; padding:5px 12px; border-radius:10px; background:white;">
                üî• <span id="streakDisplay">0</span>
            </div>
            <button class="history-btn" onclick="openHistoryModal()">üìÖ L·ªãch s·ª≠</button>
            <button class="history-btn" onclick="openSettingsModal()">‚öôÔ∏è</button>
            <button class="history-btn" onclick="openAboutModal()">‚ÑπÔ∏è</button>
        </div>
    </div>

    <div class="challenge-info" id="challengeBox">
        <div style="display:flex; justify-content:space-between; align-items:flex-end;">
            <div style="text-align:left;">
                <div style="font-size:15px; font-weight:bold; opacity:1; letter-spacing: 1px;">TH·ª¨ TH√ÅCH 90 NG√ÄY</div>
                <div style="font-size:26px; font-weight:bold; color:var(--primary-yellow);" id="dayCounter">Loading...</div>
            </div>
            <div style="font-size:14px; font-weight:bold;" id="percentDisplay">0%</div>
        </div>
        <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
        </div>
        <div id="startBtnArea" style="margin-top:15px; display:none; border-top: 1px solid #333; padding-top: 10px;">
            <button onclick="startChallenge()" style="background:var(--primary-yellow); color:black; border:none; padding:8px 15px; border-radius:6px; font-weight:bold; cursor:pointer; width: 100%;">üöÄ B·∫Øt ƒë·∫ßu NGAY H√îM NAY</button>
        </div>
    </div>

    <div class="card">
        <div class="section-title">6 Th√≥i Quen C·ªët L√µi</div>
        <div class="habit-grid" id="habitContainer"></div>
        
        <div style="margin-top: 15px; display: flex; gap: 10px;">
            <div class="time-box">
                <label>üåô Gi·ªù ng·ªß</label>
                <input type="time" id="sleepInput" onchange="saveTimeLog()">
            </div>
            <div class="time-box">
                <label>‚òÄÔ∏è Th·ª©c d·∫≠y</label>
                <input type="time" id="wakeInput" onchange="saveTimeLog()">
            </div>
        </div>
        
        <hr style="border:0; border-top:1px solid #eee; margin:20px 0;">
        
        <div class="section-title">Nhi·ªám v·ª•</div>
        <div class="task-grid" id="taskContainer"></div>
        <div style="text-align:center; margin-top:15px; color:#888; font-size:12px; cursor:pointer; font-weight: 500;" onclick="addTask()">+ Th√™m nhi·ªám v·ª• m·ªõi</div>
        
        <hr style="border:0; border-top:1px solid #eee; margin:20px 0;">

        <div class="split">
            <div class="col" style="flex:0.6;">
                <div class="section-title">Mood</div>
                <div class="mood-grid" id="moodContainer"></div>
            </div>
            
            <div class="col">
                <div class="section-title">Nh·∫≠t K√Ω & ·∫¢nh</div>
                <div class="integrated-box">
                    <textarea id="journalInput" class="journal-area-clean" placeholder="H√¥m nay b·∫°n th·∫ø n√†o..." oninput="autoSaveJournal()"></textarea>
                    
                    <div style="display:flex; justify-content:space-between; align-items:flex-end;">
                        <div class="photo-grid" id="photoGrid"></div>
                        <div id="saveStatus" class="save-status"></div>
                    </div>
                </div>
                <input type="file" id="imgInput" style="display:none;" accept="image/*" onchange="processImage(this)">
            </div>
        </div>
    </div>
    
    </div>

<div id="historyModal" class="modal">
    <div class="modal-content">
        <span class="close-modal" onclick="closeHistoryModal()">√ó</span>
        <h2 style="margin-top:0;">H√†nh tr√¨nh ƒë√£ qua</h2>
        <div id="historyList"></div>
        
        <div id="historyDetail" style="display:none;">
            <button onclick="backToHistoryList()" style="margin-bottom:10px; background:#eee; border:1px solid #000; padding:5px 10px; border-radius:5px; cursor:pointer;">‚Üê Quay l·∫°i</button>
            <h3 id="detailDate" style="margin-bottom:20px; border-bottom:1px solid #eee; padding-bottom:10px;">Ng√†y X</h3>
            
            <div class="history-section-block">
                <div class="history-section-title">TH√ìI QUEN:</div>
                <div id="detailHabits" class="history-habits-row"></div>
            </div>

            <div class="history-section-block">
                <div class="history-section-title">NHI·ªÜM V·ª§:</div>
                <div id="detailTasks" style="background:#fff; border:1px solid #eee; padding:10px; border-radius:8px;"></div>
            </div>
            
            <div class="history-section-block">
                <div class="history-section-title">T√ÇM TR·∫†NG:</div>
                <div id="detailMood"></div>
            </div>
            
            <div class="history-section-block">
                <div class="history-section-title">NH·∫¨T K√ù:</div>
                <div id="detailJournal" style="background:#f9f9f9; padding:10px; border-radius:8px; border:1px solid #eee; font-style:italic; white-space: pre-wrap;"></div>
            </div>
            
            <div class="history-section-block" style="margin-bottom:0;">
                <div class="history-section-title">·∫¢NH:</div>
                <div id="detailPhotos" class="photo-grid"></div>
            </div>
        </div>
    </div>
</div>

<div id="aboutModal" class="modal">
    <div class="modal-content" style="text-align: center;">
        <span class="close-modal" onclick="closeAboutModal()">√ó</span>
        
        <div style="font-size: 40px; margin-bottom: 10px;">üêú</div>
        <h2 style="margin-top: 0; text-transform: uppercase;">DucNguyen's discipline </h2>
        <p style="color: #666; font-size: 12px; font-weight: bold;">Phi√™n b·∫£n: Verson 1.15</p>
        
        <hr style="border: 0; border-top: 1px solid #eee; margin: 15px 0;">
        
        <div style="text-align: left; font-size: 14px; line-height: 1.6;">
            <p><strong>M·ª•c ti√™u:</strong> 90 ng√†y t·∫≠p trung ƒë·ªÉ k·ª∑ lu·∫≠t h∆°n c·ªßa ƒê√¨nh ƒê·ª©c.</p>
            <p><strong>Quy t·∫Øc:</strong></p>
            <ul style="padding-left: 20px; margin: 5px 0;">
                <li>Ho√†n th√†nh 6 th√≥i quen c·ªët l√µi.</li>
                <li>Ghi l·∫°i nh·∫≠t k√Ω v√† c·∫£m x√∫c m·ªói ng√†y.</li>
                <li>Kh√¥ng khoe khoang, √¢m th·∫ßm th·ª±c hi·ªán.</li>
            </ul>
        </div>

        <hr style="border: 0; border-top: 1px solid #eee; margin: 15px 0;">
        <p style="font-size: 12px; color: #888;">Powered by Firebase & GitHub</p>
    </div>
</div>

<div id="settingsModal" class="modal">
    <div class="modal-content">
        <span class="close-modal" onclick="closeSettingsModal()">√ó</span>
        <h2 style="margin-top:0;">C√†i ƒë·∫∑t</h2>
        
        <div style="display:flex; flex-direction:column; gap:15px; margin-top:20px;">
            
            <div>
                <div style="font-weight:bold; margin-bottom:5px;">üõ†Ô∏è C√¥ng c·ª• Test</div>
                <button onclick="simulateNewDay()" style="width:100%; padding:10px; background:#e3f2fd; color:#1565c0; border:1px solid #1565c0; border-radius:8px; font-weight:bold; cursor:pointer;">
                    ‚è© Gi·∫£ l·∫≠p Qua ng√†y m·ªõi
                </button>
                <div style="font-size:11px; color:#666; margin-top:3px;">D√πng ƒë·ªÉ ki·ªÉm tra t√≠nh nƒÉng l∆∞u l·ªãch s·ª≠ & streak.</div>
            </div>

            <hr style="width:100%; border:0; border-top:1px solid #eee;">

            <div>
                <div style="font-weight:bold; margin-bottom:5px; color:red;">‚ö†Ô∏è V√πng nguy hi·ªÉm</div>
                <button onclick="hardReset()" style="width:100%; padding:10px; background:#ffebee; color:red; border:1px solid red; border-radius:8px; font-weight:bold; cursor:pointer;">
                    ‚ò†Ô∏è Reset to√†n b·ªô d·ªØ li·ªáu
                </button>
                <div style="font-size:11px; color:#666; margin-top:3px;">X√≥a s·∫°ch m·ªçi th·ª© v√† quay v·ªÅ ng√†y 1. Kh√¥ng th·ªÉ ho√†n t√°c.</div>
            </div>

            <div>
                <div style="font-weight:bold; margin-bottom:5px;">üìä D·ªØ li·ªáu</div>
                <button onclick="exportToCSV()" style="width:100%; padding:10px; background:#e8f5e9; color:#2e7d32; border:1px solid #2e7d32; border-radius:8px; font-weight:bold; cursor:pointer;">
                    üì• T·∫£i file b√°o c√°o (.csv)
                </button>
                <div style="font-size:11px; color:#666; margin-top:3px;">M·ªü ƒë∆∞·ª£c b·∫±ng Google Sheets ho·∫∑c Excel.</div>
            </div>


        </div>
    </div>
</div>

<div id="lightbox" class="lightbox" onclick="closeLightbox()">
    <div class="lightbox-close">√ó</div>
    <img id="lightboxImg" src="" onclick="event.stopPropagation()">
</div>

<script type="module" src="app.js"></script>

</body>
</html>